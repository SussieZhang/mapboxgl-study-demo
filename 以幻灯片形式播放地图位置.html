<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Play map locations as a slideshow</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<style>
.map-overlay-container {
    position: absolute;
    width: 25%;
    top: 0;
    left: 0;
    padding: 10px;
    z-index: 1;
}

.map-overlay {
    font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    background-color: #fff;
    border-radius: 3px;
    padding: 10px;
    box-shadow:0 1px 2px rgba(0,0,0,0.20);
}

.map-overlay h2,
.map-overlay p {
    margin: 0 0 10px;
}
</style>

<div id='map'></div>

<div class='map-overlay-container'>
  <div class='map-overlay'>
    <h2 id='location-title'></h2>
    <p id='location-description'></p>
    <small>Text credit: <a target='_blank' href='http://www.nycgo.com/neighborhoods'>nycgo.com</a></small>
  </div>
</div>

<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiemhhbmdjYW55dTEyMyIsImEiOiJja2FmNjN2eTEwY2lmMnRtdnA4YjB5N2sxIn0.qoR7Pwgakh7CaAqFHjisgQ';
var map = new mapboxgl.Map({
    style: 'mapbox://styles/mapbox/light-v9',
    center: [113.86947154998778,22.507670620470137],
    zoom: 15.5,
    pitch: 45,
    bearing: -17.6,
    container: 'map'
});

var title = document.getElementById('location-title');
var description = document.getElementById('location-description');

var locations = [
       {
                "id": "2",
                "title": "前海片区",
                "description": "This is where hip-hop was born, where the Yankees became a dynasty and where you can find New York City's leading zoo and botanical garden.",
                "camera": {
                    center: [	
                    113.87191772460938,
                    22.50811664185366
                ],
                    zoom: 14.21,
                    pitch: 60,
                }
                }, {
                "id": "3",
                "title": "大小南山片区",
                "description": "No matter how hip it looks on TV, NYC's most populous borough is best experienced in person. Read on to find out about live music, Prospect Park, Nets basketball and more.",
                "camera": {
                    center: [
                    113.89346122741699,
                    22.489957452999935
                    ],
                    bearing: -8.9,
                    pitch: 60,
                    zoom: 14.68
                }
            }, {
                "id": "1",
                "title": "蛇口片区",
                "description": "Even if you think you know Manhattan—its world-class museums, fine dining and unforgettable views—the borough always has something new and exciting in store.",
                "camera": {
                    center: [
                    113.92667770385742,
                    22.494556948949963
                ],
                    bearing: 25.3,
                    pitch: 60,
                    zoom: 14.5
                }
                }, {
                "id": "4",
                "title": "蛇口南及赤湾片区",
                "description": "Taste food from around the globe, watch Mets baseball and US Open tennis, see cutting-edge art and more in one of the world's most diverse places.",
                "camera": {
                    center: [
                    113.89071464538574,
                    22.46465749338863
                    ],
                    bearing: 36,
                    pitch: 60,
                    zoom: 14.37
                }
                }, {
                "title": "大自贸区",
                "description": "New York City is made up of five boroughs: the Bronx, Brooklyn, Manhattan, Queens and Staten Island. Each one has enough attractions—and enough personality—to be a city all its own.",
                "camera": {
                    center: [
                            113.87335538864136,
                            22.517215163995573
                        ],
                    zoom:12.68,
                    bearing: 0,
                    pitch: 0
                }
            }];

function highlightBorough(code) {
    console.log('code',code)
    // Only show the polygon feature that cooresponds to `borocode` in the data
    map.setFilter('highlight', ["==", "borocode", code]);
}

function playback(index) {
    title.textContent = locations[index].title;
    description.textContent = locations[index].description;

    highlightBorough(locations[index].id ? locations[index].id : '');

    // Animate the map position based on camera properties
    map.flyTo(locations[index].camera);

    map.once('moveend', function() {
        // Duration the slide is on screen after interaction
        window.setTimeout(function() {
            // Increment index
            index = (index + 1 === locations.length) ? 0 : index + 1;
            playback(index);
        }, 3000); // After callback, show the location for 3 seconds.
    });
}

// Display the last title/description first
title.textContent = locations[locations.length - 1].title;
description.textContent = locations[locations.length - 1].description;

map.on('load', function() {
       var layers = map.getStyle().layers;

            var labelLayerId;
            for (var i = 0; i < layers.length; i++) {
                if (layers[i].type === 'symbol' && layers[i].layout['text-field']) {
                    labelLayerId = layers[i].id;
                    break;
                }
            }

            map.addLayer({
                'id': '3d-buildings',
                'source': 'composite',
                'source-layer': 'building',
                'filter': ['==', 'extrude', 'true'],
                'type': 'fill-extrusion',
                'minzoom': 10,
                'paint': {
                    'fill-extrusion-color': '#aaa',
                    // use an 'interpolate' expression to add a smooth transition effect to the
                    // buildings as the user zooms in
                    'fill-extrusion-height': [
                        "interpolate", ["linear"], ["zoom"],
                        10, 0,
                        10.05, ["get", "height"]
                    ],
                    'fill-extrusion-base': [
                        "interpolate", ["linear"], ["zoom"],
                        10, 0,
                        10.05, ["get", "min_height"]
                    ],
                    'fill-extrusion-opacity': .6
                }
            }, labelLayerId);

let data =
{
  "type": "geojson",
  "data": {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "borocode": '2'
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              113.86608123779297,
              22.489878150004987
            ],
            [
              113.87054443359375,
              22.491781409341186
            ],
            [
              113.86865615844727,
              22.499869969464825
            ],
            [
              113.8817024230957,
              22.505420668446295
            ],
            [
              113.88925552368163,
              22.51112972639767
            ],
            [
              113.90007019042967,
              22.52080286973367
            ],
            [
              113.90230178833008,
              22.524132811597127
            ],
            [
              113.90195846557617,
              22.54648891373442
            ],
            [
              113.89766693115234,
              22.55013531037697
            ],
            [
              113.89406204223633,
              22.554257207940832
            ],
            [
              113.88341903686523,
              22.54474495084633
            ],
            [
              113.88599395751953,
              22.534914929744517
            ],
            [
              113.88582229614258,
              22.532536593686054
            ],
            [
              113.8817024230957,
              22.526194163960483
            ],
            [
              113.86247634887695,
              22.516204246664763
            ],
            [
              113.86196136474608,
              22.513508430967846
            ],
            [
              113.86470794677734,
              22.50161449886315
            ],
            [
              113.8623046875,
              22.49939418490125
            ],
            [
              113.86402130126953,
              22.495112050190716
            ],
            [
              113.86608123779297,
              22.489878150004987
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "borocode": '4'
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              113.87054443359375,
              22.492019314917705
            ],
            [
              113.86942863464355,
              22.490988387798875
            ],
            [
              113.86865615844727,
              22.49051257269214
            ],
            [
              113.86642456054688,
              22.489957452999935
            ],
            [
              113.87157440185547,
              22.474571821398893
            ],
            [
              113.87906312942503,
              22.460017344171835
            ],
            [
              113.88146638870239,
              22.461088161626975
            ],
            [
              113.88075828552246,
              22.470090633013765
            ],
            [
              113.88032913208006,
              22.471002745055436
            ],
            [
              113.87700319290161,
              22.47526579778561
            ],
            [
              113.87914896011353,
              22.479152001285943
            ],
            [
              113.88577938079834,
              22.476197703463267
            ],
            [
              113.88440608978271,
              22.473758873208975
            ],
            [
              113.88346195220947,
              22.473758873208975
            ],
            [
              113.88331174850462,
              22.47189502276308
            ],
            [
              113.88322591781616,
              22.469654403392582
            ],
            [
              113.88477087020874,
              22.46747323468202
            ],
            [
              113.885178565979,
              22.468048273402623
            ],
            [
              113.88670206069946,
              22.46759220840625
            ],
            [
              113.88745307922363,
              22.467017167792733
            ],
            [
              113.88768911361694,
              22.46598605450914
            ],
            [
              113.88749599456787,
              22.464974762873712
            ],
            [
              113.88796806335449,
              22.462575394366905
            ],
            [
              113.88638019561768,
              22.4617227162148
            ],
            [
              113.88659477233885,
              22.45783602376454
            ],
            [
              113.8849639892578,
              22.455218393963666
            ],
            [
              113.88565063476562,
              22.44724621692995
            ],
            [
              113.88708829879761,
              22.446512436308264
            ],
            [
              113.89605760574341,
              22.45771704166413
            ],
            [
              113.89395475387573,
              22.46648178300711
            ],
            [
              113.89655113220215,
              22.467909471171343
            ],
            [
              113.8986325263977,
              22.465886908596723
            ],
            [
              113.90397548675537,
              22.469515602770485
            ],
            [
              113.90105724334715,
              22.472787294722988
            ],
            [
              113.90290260314941,
              22.474254573892498
            ],
            [
              113.90324592590332,
              22.47536493698556
            ],
            [
              113.90616416931152,
              22.471954507739227
            ],
            [
              113.90985488891602,
              22.470050975832237
            ],
            [
              113.91071319580078,
              22.470923431203282
            ],
            [
              113.90976905822754,
              22.471637254237915
            ],
            [
              113.90994071960448,
              22.472271760513905
            ],
            [
              113.91114234924316,
              22.472113134217395
            ],
            [
              113.91054153442383,
              22.47290626388335
            ],
            [
              113.91242980957031,
              22.47377870127039
            ],
            [
              113.90951156616211,
              22.475206314231578
            ],
            [
              113.90899658203125,
              22.476871844087007
            ],
            [
              113.90796661376952,
              22.478140805770096
            ],
            [
              113.90976905822754,
              22.478140805770096
            ],
            [
              113.90942573547363,
              22.47877528225095
            ],
            [
              113.91011238098145,
              22.479647682665203
            ],
            [
              113.90779495239258,
              22.48052007758286
            ],
            [
              113.9065933227539,
              22.47972699152122
            ],
            [
              113.90281677246094,
              22.476951154532866
            ],
            [
              113.89723777770996,
              22.48250277286201
            ],
            [
              113.88891220092772,
              22.489719543878778
            ],
            [
              113.88874053955078,
              22.493763943314192
            ],
            [
              113.88633728027344,
              22.497728926041635
            ],
            [
              113.88050079345703,
              22.496618742331982
            ],
            [
              113.87955665588379,
              22.497728926041635
            ],
            [
              113.87646675109863,
              22.496856639591186
            ],
            [
              113.87432098388672,
              22.49614294658633
            ],
            [
              113.87389183044434,
              22.494715549531715
            ],
            [
              113.87243270874022,
              22.493367438791978
            ],
            [
              113.87054443359375,
              22.492019314917705
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "borocode": '1'
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              113.89680862426756,
              22.482820001471737
            ],
            [
              113.90268802642821,
              22.476990809738773
            ],
            [
              113.90783786773682,
              22.48052007758286
            ],
            [
              113.90974760055542,
              22.479707164311474
            ],
            [
              113.91268730163574,
              22.478239942911856
            ],
            [
              113.91195774078369,
              22.478874418938478
            ],
            [
              113.91131401062012,
              22.481035581086868
            ],
            [
              113.91262292861938,
              22.482681214044426
            ],
            [
              113.91401767730713,
              22.482443292416768
            ],
            [
              113.91498327255249,
              22.481888140362162
            ],
            [
              113.91629219055176,
              22.481907967259588
            ],
            [
              113.91725778579712,
              22.482482946049775
            ],
            [
              113.91770839691162,
              22.48335532310232
            ],
            [
              113.91702175140381,
              22.487697299836604
            ],
            [
              113.91897439956665,
              22.48751886512017
            ],
            [
              113.9206051826477,
              22.48680512395414
            ],
            [
              113.92219305038452,
              22.487578343384545
            ],
            [
              113.92300844192505,
              22.487221473414944
            ],
            [
              113.92270803451538,
              22.486527556951163
            ],
            [
              113.92528295516968,
              22.485774157994506
            ],
            [
              113.92491817474365,
              22.4837915095671
            ],
            [
              113.92178535461424,
              22.48442596015342
            ],
            [
              113.92124891281128,
              22.48260190688063
            ],
            [
              113.92388820648193,
              22.481907967259588
            ],
            [
              113.93096923828124,
              22.480044226491
            ],
            [
              113.93120527267456,
              22.482026928584514
            ],
            [
              113.93167734146117,
              22.483276016324698
            ],
            [
              113.9328145980835,
              22.484267347779447
            ],
            [
              113.93378019332886,
              22.485060407831938
            ],
            [
              113.93626928329466,
              22.48305792245199
            ],
            [
              113.93792152404784,
              22.4839699490884
            ],
            [
              113.93826484680176,
              22.4844854397468
            ],
            [
              113.93901586532593,
              22.485278498549853
            ],
            [
              113.93792152404784,
              22.4869439072469
            ],
            [
              113.93877983093262,
              22.488371384467076
            ],
            [
              113.9435863494873,
              22.48813347261943
            ],
            [
              113.94659042358398,
              22.490195361712114
            ],
            [
              113.94641876220702,
              22.50795805663768
            ],
            [
              113.93054008483887,
              22.508195934393456
            ],
            [
              113.91234397888184,
              22.508275226887754
            ],
            [
              113.91268730163574,
              22.504231251704084
            ],
            [
              113.9132237434387,
              22.5012576650944
            ],
            [
              113.91277313232422,
              22.500147509704494
            ],
            [
              113.91195774078369,
              22.50072241271518
            ],
            [
              113.91013383865356,
              22.499949266732983
            ],
            [
              113.91075611114502,
              22.49929506291119
            ],
            [
              113.9099621772766,
              22.49784787376783
            ],
            [
              113.9087176322937,
              22.49749103028242
            ],
            [
              113.90764474868773,
              22.49764962750068
            ],
            [
              113.90755891799927,
              22.497114361160342
            ],
            [
              113.9061427116394,
              22.496598917541906
            ],
            [
              113.90676498413086,
              22.49596452275984
            ],
            [
              113.90783786773682,
              22.494477648590905
            ],
            [
              113.9068078994751,
              22.4942000969763
            ],
            [
              113.90569210052489,
              22.492911457186793
            ],
            [
              113.90483379364014,
              22.49257442633893
            ],
            [
              113.90324592590332,
              22.4890454658145
            ],
            [
              113.90331029891968,
              22.488549818084426
            ],
            [
              113.90519857406616,
              22.488351558495395
            ],
            [
              113.90603542327881,
              22.487419734622765
            ],
            [
              113.90650749206543,
              22.48696373342021
            ],
            [
              113.90717267990112,
              22.486785297758093
            ],
            [
              113.90734434127806,
              22.486111205403077
            ],
            [
              113.90704393386841,
              22.485318151370738
            ],
            [
              113.9065933227539,
              22.485357804180275
            ],
            [
              113.9055848121643,
              22.485456936154385
            ],
            [
              113.9048981666565,
              22.48617068427234
            ],
            [
              113.90440464019775,
              22.487102516553943
            ],
            [
              113.90419006347656,
              22.48682495014734
            ],
            [
              113.90127182006836,
              22.486924081070736
            ],
            [
              113.90127182006836,
              22.486626688087554
            ],
            [
              113.9022159576416,
              22.484881969716266
            ],
            [
              113.90195846557617,
              22.483771682939427
            ],
            [
              113.90101432800293,
              22.482661387257735
            ],
            [
              113.90067100524902,
              22.484009602284136
            ],
            [
              113.89680862426756,
              22.482820001471737
            ]
          ]
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "borocode": '3'
      },
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              113.89972686767577,
              22.520287514417266
            ],
            [
              113.88174533843994,
              22.505420668446295
            ],
            [
              113.8686990737915,
              22.499711374792128
            ],
            [
              113.87045860290526,
              22.492177918408135
            ],
            [
              113.8736343383789,
              22.494636249263568
            ],
            [
              113.87432098388672,
              22.496103296867005
            ],
            [
              113.87947082519531,
              22.497728926041635
            ],
            [
              113.8808012008667,
              22.49677734055024
            ],
            [
              113.88655185699463,
              22.49757032891427
            ],
            [
              113.88861179351807,
              22.493962195149223
            ],
            [
              113.88895511627197,
              22.489878150004987
            ],
            [
              113.89685153961182,
              22.482978615504003
            ],
            [
              113.90054225921631,
              22.483811336191952
            ],
            [
              113.90122890472412,
              22.482820001471737
            ],
            [
              113.90234470367432,
              22.484525092794865
            ],
            [
              113.90092849731445,
              22.48682495014734
            ],
            [
              113.90213012695312,
              22.48682495014734
            ],
            [
              113.90444755554199,
              22.48682495014734
            ],
            [
              113.90504837036133,
              22.485754331650806
            ],
            [
              113.90672206878662,
              22.485318151370738
            ],
            [
              113.907151222229,
              22.486230163116037
            ],
            [
              113.9065933227539,
              22.48706286424421
            ],
            [
              113.90466213226317,
              22.4882920805633
            ],
            [
              113.90324592590332,
              22.488450688325408
            ],
            [
              113.9033317565918,
              22.48920407271324
            ],
            [
              113.90482306480406,
              22.49254468828353
            ],
            [
              113.90562772750854,
              22.492876762872704
            ],
            [
              113.90682935714722,
              22.4941852281241
            ],
            [
              113.90785932540894,
              22.494462779768522
            ],
            [
              113.9061588048935,
              22.496574136550336
            ],
            [
              113.90749454498291,
              22.49764962750068
            ],
            [
              113.9100694656372,
              22.49792717219515
            ],
            [
              113.91075611114502,
              22.49927523850465
            ],
            [
              113.91028404235838,
              22.499949266732983
            ],
            [
              113.91191482543944,
              22.500504346337248
            ],
            [
              113.91294479370117,
              22.500068212549984
            ],
            [
              113.91315937042236,
              22.501416257994165
            ],
            [
              113.91238689422607,
              22.50811664185366
            ],
            [
              113.91860961914062,
              22.508354519336596
            ],
            [
              113.91534805297852,
              22.51033681577882
            ],
            [
              113.9111852645874,
              22.514975278382796
            ],
            [
              113.9059066772461,
              22.51525278830483
            ],
            [
              113.89972686767577,
              22.520287514417266
            ]
          ]
        ]
      }
    }
  ]
}
}

    map.addLayer({
        "id": "highlight",
        "type": "fill",
        "source": data,
        'layout': {},
         'paint': {
                'fill-color': '#003997',
                'fill-opacity': 0.4
            },
        "filter": ["==", "borocode", ""]
    }); // Place polygon under the neighborhood labels.

    // Start the playback animation for each borough
    playback(0);
});
</script>

</body>
</html>